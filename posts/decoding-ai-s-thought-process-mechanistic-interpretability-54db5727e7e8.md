---
title: "Decoding AI’s Thought Process: Mechanistic Interpretability"
date: "2023-11-04"
coverImage: "https://cdn-images-1.medium.com/max/1024/0*-Z4XL91lYNGItrL0"
canonical: "https://medium.com/@prdeepak.babu/decoding-ais-thought-process-mechanistic-interpretability-54db5727e7e8"
mediumId: "54db5727e7e8"
source: "medium"
---

<section name="7f44" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="3f04" id="3f04" class="graf graf--p graf-after--h3">Mechanistic Interpretability is a field of study that concerns study of neural networks (more generally ML models) with an intent to understand and explain inner workings of a machine learned model. This has particularly become important due to the rise of deep learning and neural network based techniques which learn from large datasets through supervised and self-supervised means leading to super-human performance, beating human baselines in many cases. More recently, Transformer architecture based LLMs have revolutionized AI as being general reasoning machines that can not just learn from text data but understand multi-modal data (vision and speech included) mimicking vaguely how humans sense the world and respond to stimuli. This is already enough justification to invest in interpretability research so we have sufficient oversight on benefits and harm these models can have on our society. LLMs are notoriously known for hallucinating facts in QA, imagine if we somehow could peek into the activations to identify node(s) that are active when a model is hallucinating, we could have interventions that can prevent them in first place.</p><figure name="7276" id="7276" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yVzSUSib0eMsBA4nFFfD8A.png" data-width="412" data-height="405" src="https://cdn-images-1.medium.com/max/800/1*yVzSUSib0eMsBA4nFFfD8A.png"></figure><p name="1ec5" id="1ec5" class="graf graf--p graf-after--figure">Mechanistic interpretability is akin to reverse-engineering the model to comprehend its “thought” processes. This is an active area of research in AI, with techniques like layer-wise relevance propagation, saliency maps, and attention mechanisms being explored to provide insights into the inner workings of complex models</p><p name="7064" id="7064" class="graf graf--p graf-after--p">This rest of the article is roughly divided into two phases <br>(i) Reasons why we need this research and <br>(ii) Recent work and findings from this research in the context of LLMs. Specifically, we discuss recent works from Deepmind and MIT/Meta.</p><p name="16b5" id="16b5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Why do we need to study interpretability ?</strong></p><ul class="postList"><li name="15c2" id="15c2" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">Bias and Alignment with Human Values</strong>: The pursuit of mechanistic interpretability is essential in ensuring that AI systems operate without bias. It is paramount that AI decisions are aligned with human values, particularly concerning sensitive characteristics such as age and gender. For example, in the recruitment domain, it is crucial that job applicants are evaluated based on their qualifications rather than discriminatory factors — a goal that requires careful scrutiny of the training data to prevent inherent biases, such as a model that has learned to prefer one gender over another due to biased historical hiring practices.</li><li name="d425" id="d425" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Trustworthiness of AI System</strong>s: We need to study mechanistic interpretability to cement the trustworthiness of AI systems. By understanding the internal mechanics of AI decision-making, we ensure that these systems can be relied upon without skepticism. Trust in AI is not a given; it is built on the clarity and justifiability of its processes and outputs.</li><li name="e1a9" id="e1a9" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Factuality Over Fabrication</strong>: AI systems must be designed to adhere to facts and resist the temptation to ‘hallucinate’ or fabricate information. Mechanistic interpretability studies the AI’s decision-making process to guard against the creation of convincing yet untrue facts, which could otherwise mislead individuals and propagate misinformation.</li><li name="6b96" id="6b96" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Regulatory Compliance in High-Stakes Fields</strong>: In sectors where the stakes are particularly high, such as finance, the demand for explainable AI is not just practical but regulatory. For instance, if a loan application is denied, regulatory frameworks mandate that the decision be transparent and explainable to the customer. This requirement ensures that a deep learning model’s high-confidence prediction of a loan default is accompanied by a rational and understandable explanation.</li><li name="9c8e" id="9c8e" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">Enhancing Human Efficacy and Discovery</strong>: Finally, studying mechanistic interpretability has the potential to amplify human intellect by unraveling complex concepts that have yet to be discovered. This can lead to significant advancements in various fields, such as improving healthcare treatments and interventions, by leveraging AI’s ability to identify patterns and correlations beyond human discernment.</li></ul><p name="736a" id="736a" class="graf graf--p graf-after--li"><strong class="markup--strong markup--p-strong">Recent Work on Mechanistic Interpretability</strong></p><p name="97b0" id="97b0" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“<a href="https://arxiv.org/abs/2310.16410" data-href="https://arxiv.org/abs/2310.16410" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">Bridging the Human–AI Knowledge Gap: Concept Discovery and Transfer in AlphaZero</a>” is a paper from Google Deepmind, where authors study the behavior of AlphaZero to understand novel concepts in the way it plays the game of chess. AlphaZero is an AI system that mastered the game of chess via self-play without human supervision. They particularly choose AI that knows to play chess, as it is a game that is well understood and groundtruth is much easier to validate unlike science or medicine. There is also a quantitative measure of the quality of play, both for human experts as well as machines, known as the Elo rating.</p><p name="49c9" id="49c9" class="graf graf--p graf-after--p">They motivate the need for humans to learn from machines with an example of a system capable of producing a more accurate cancer diagnosis or effective personalised treatment than human experts is useful, transferring the rationale behind their decisions to human doctors could not only bring advances in medicine but also leverage human doctors’ strength and generalisation ability to enable new breakthroughs.</p><p name="50d8" id="50d8" class="graf graf--p graf-after--figure">The human representational space (H) has some overlap with the machine representational space (M). A representational space forms the basis of and gives rise to knowledge and abilities, which is of ultimate interest. Authors use representational space and knowledge interchangeably roughly speaking, H to represent what humans know and M to represent what a machine knows. There are things that both AI and humans know (M intersect H), things that only humans know (H-M), and things only machines know (M-H). Most existing research efforts only focus on (M intersect H). Authors posit that the knowledge gap represented by (M-H) holds the crucial key to empowering humans by identifying new concepts and new connections between existing concepts within highly performant AI systems.</p><blockquote name="384c" id="384c" class="graf graf--blockquote graf--hasDropCapModel graf-after--p">One prominent example in the history of AI is the move 37 that AlphaGo made in a match with Lee Sedol. This move came as a complete surprise to the commentators and the player, and is still discussed to this day as an example of machine-unique knowledge. The vision to pursue super-human knowledge is ultimately for human-centered AI, and a world where human agency and capability do not come second.</blockquote><p name="ea94" id="ea94" class="graf graf--p graf-after--blockquote">Authors show a methodology to mine novel concepts from AlphaZero, ensure they are teachable concepts to humans and verify the knowledge transferability by working 4 chess grandmasters, the best chess players in the world.</p><p name="e176" id="e176" class="graf graf--p graf-after--p">Another popular and recent paper in this space includes “<a href="https://arxiv.org/abs/2310.02207" data-href="https://arxiv.org/abs/2310.02207" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">LANGUAGE MODELS REPRESENT SPACE AND TIME</a>” from MIT, where authors study Llama 2 models on spatial (world, US, NYC) and temporal datasets(historical figure, news, artwork) and find LLMs learn linear representations of space and time across multiple scales. These representations are robust to prompting variations and unified across different entity types (e.g. cities and landmarks). Further they go on to conclude that modern LLMs acquire structured knowledge about fundamental dimensions such as space and time, supporting the view that they learn not merely superficial statistics, but literal world models.</p><figure name="e2cc" id="e2cc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="0*0Ls5kgRzYPCaDoju" data-width="792" data-height="507" src="https://cdn-images-1.medium.com/max/800/0*0Ls5kgRzYPCaDoju"></figure><p name="d241" id="d241" class="graf graf--p graf-after--figure">Below are some highlights of the paper</p><ul class="postList"><li name="7a5b" id="7a5b" class="graf graf--li graf-after--p">Train linear regression probes on the internal activations of the names of these places and events at each layer to predict their real-world location or time.</li><li name="a44c" id="a44c" class="graf graf--li graf-after--li">These representations are linear (R2 does not support non-linearity), robust to prompting and unified across entities (cities and natural landmarks)</li><li name="0a6d" id="0a6d" class="graf graf--li graf-after--li">The probe learns the mapping from model coordinates to human interpretable coordinates.</li><li name="69d5" id="69d5" class="graf graf--li graf-after--li">What is probing ? fits a simple linear ridge regression model on the network activations to predict some target label associated with labeled input data. In particular, given an activation dataset A and a target Y containing either the time or two-dimensional latitude and longitude coordinates.</li><li name="9242" id="9242" class="graf graf--li graf-after--li">The early layers (25%) are responsible for recall of information.</li><li name="cac6" id="cac6" class="graf graf--li graf-after--li">Adding non-linearity in the fitted model doesn’t change the explained variance wrt linear model indicating the presence of linear relationship.</li><li name="0c81" id="0c81" class="graf graf--li graf-after--li">Robust to prompting strategies</li></ul><p name="b4a3" id="b4a3" class="graf graf--p graf-after--li">In conclusion, the imperative to study and advance mechanistic interpretability is clear. By unpacking the ‘black box’ of AI, we ensure that the technology we increasingly rely on operates in a manner that is ethical, understandable, and beneficial. MI is an active area of research, that is extensively studied by OpenAI, Anthrophic, Google and other teams building world models that serve as a backbone for futuristic AGI solutions.</p><p name="9e69" id="9e69" class="graf graf--p graf-after--p graf--trailing"><strong class="markup--strong markup--p-strong">Related Articles</strong><br><a href="https://medium.com/@prdeepak.babu/reward-hacking-in-large-language-models-llms-c57abbc0cde7" data-href="https://medium.com/@prdeepak.babu/reward-hacking-in-large-language-models-llms-c57abbc0cde7" class="markup--anchor markup--p-anchor" target="_blank">Reward Hacking in LLMs</a><br><a href="https://medium.com/@prdeepak.babu/emergent-abilities-in-llm-unpredictable-abilities-in-large-language-models-72fc54059b41" data-href="https://medium.com/@prdeepak.babu/emergent-abilities-in-llm-unpredictable-abilities-in-large-language-models-72fc54059b41" class="markup--anchor markup--p-anchor" target="_blank">Emergent Abilities &amp; Theory of Mind in LLM</a><br><a href="https://medium.com/@prdeepak.babu/exploring-the-llm-landscape-from-parametric-memory-to-agent-oriented-models-ab0088d1f14" data-href="https://medium.com/@prdeepak.babu/exploring-the-llm-landscape-from-parametric-memory-to-agent-oriented-models-ab0088d1f14" class="markup--anchor markup--p-anchor" target="_blank">LLM landscape &amp; model types</a></p></div></div></section>

<hr>

<p><em>Originally published on Medium:</em> <a href="https://medium.com/@prdeepak.babu/decoding-ais-thought-process-mechanistic-interpretability-54db5727e7e8">https://medium.com/@prdeepak.babu/decoding-ais-thought-process-mechanistic-interpretability-54db5727e7e8</a></p>
